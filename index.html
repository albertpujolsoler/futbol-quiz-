<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fútbol Quiz — Dificultad Alta</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3E%F0%9F%8F%8A%EF%B8%8F%3C/text%3E%3C/svg%3E">
<style>
  :root{--bg:#0b0b0e;--card:#ffffffee;--accent:#1f8eeb;--ok:#22c55e;--wrong:#fecaca;--text:#0d0d10;}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:16px system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Helvetica Neue',Arial}
  .wrap{min-height:100svh;display:grid;place-items:center;padding:16px}
  .card{width:min(680px,100%);background:var(--card);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:16px}
  h1,h2{margin:0 0 8px}
  .row{display:flex;justify-content:space-between;align-items:center;gap:12px}
  .muted{color:#5f5f6a;font-size:12px}
  .btn{appearance:none;border:0;border-radius:14px;background:var(--accent);color:#fff;font-weight:600;padding:12px 16px;cursor:pointer}
  .btn:disabled{opacity:.55;cursor:not-allowed}
  input,.input{width:100%;padding:12px 14px;border-radius:14px;border:1px solid #ddd;outline:none}
  .question{font-weight:700;text-align:center;border:1px solid #e6e6ea;border-radius:14px;padding:14px}
  .opts{display:grid;gap:10px}
  .opt{background:#fff;border:1px solid #e6e6ea;border-radius:14px;padding:14px;text-align:left;transition:transform .08s ease,opacity .3s}
  .opt:active{transform:scale(.98)}
  .progress{height:8px;background:#00000012;border-radius:999px;overflow:hidden}
  .bar{height:100%;background:var(--accent);width:0%}
  .fade{opacity:0;transition:opacity .3s ease}
  .fade.show{opacity:1}
  .pill{display:inline-flex;align-items:center;gap:8px;background:#f3f4f7;border-radius:999px;padding:6px 10px;font-size:12px}
  .list{display:grid;gap:8px}
  .rowitem{display:flex;align-items:center;justify-content:space-between;border:1px solid #e8e8ee;border-radius:12px;padding:10px;background:#fff}
  .small{font-size:13px}
  .center{text-align:center}
  @media (max-width:420px){ body{font-size:15px} }
</style>
</head>
<body>
<div class="wrap"><div class="card">
  <div id="app" class="fade show"></div>
</div></div>
<script>
(function(){
  var PIN_CODE='1899', QUESTIONS_COUNT=20, SECONDS_PER_QUESTION=10, STREAK_BONUS_AT=10;
  var LS={ leaderboard:'futquiz_leaderboard_v1' };

  // PREGUNTAS DIFICULTAD ALTA (mezcla general)
  var QUESTIONS=[
    { t:'¿Quién fue el máximo goleador del Mundial 1982 (España)?', o:['Zico','Paolo Rossi','Karl-Heinz Rummenigge','Socrates','Falcão'], c:1 },
    { t:'¿Qué entrenador logró el triplete (Liga, Copa y Champions) con el Inter en 2010?', o:['Mancini','Mourinho','Ancelotti','Capello','Lippi'], c:1 },
    { t:'¿Qué selección ganó el oro olímpico en Barcelona 1992 (fútbol masculino)?', o:['Brasil','Italia','España','Polonia','Suecia'], c:2 },
    { t:'¿Qué equipo eliminó a Brasil en el famoso “partido de Sarrià” (Mundial 1982)?', o:['Argentina','Alemania','Italia','Francia','Países Bajos'], c:2 },
    { t:'¿Qué país ha disputado todos los Mundiales desde 1930 sin faltar a ninguno?', o:['Alemania','Brasil','Italia','Argentina','Uruguay'], c:1 },
    { t:'¿Quién marcó el gol de oro que dio la Eurocopa 2000 a Francia?', o:['Henry','Zidane','Trezeguet','Anelka','Pires'], c:2 },
    { t:'¿En qué club jugaba George Weah cuando ganó el Balón de Oro (1995)?', o:['PSG','AC Milan','Monaco','Chelsea','Parma'], c:1 },
    { t:'¿Qué estadio albergó la final del “Maracanazo” (Mundial 1950)?', o:['Monumental','Azteca','Maracaná','Centenario','San Siro'], c:2 },
    { t:'¿Quién es el jugador con más partidos disputados en la historia de la Champions League?', o:['Iker Casillas','Xavi','Cristiano Ronaldo','Lionel Messi','Raúl'], c:2 },
    { t:'¿Qué club ganó la Champions 1999 con dos goles en el descuento?', o:['Real Madrid','Manchester United','Barcelona','Juventus','Bayern'], c:1 },
    { t:'¿Quién es el entrenador con más Champions como técnico?', o:['Ferguson','Guardiola','Ancelotti','Zidane','Mourinho'], c:2 },
    { t:'¿Qué equipo tiene más Copas Libertadores?', o:['Boca Juniors','Peñarol','River Plate','Independiente','Santos'], c:3 },
    { t:'¿Cuántos goles marcó Messi en la Liga 2011–12 (récord de una temporada)?', o:['46','47','48','50','52'], c:3 },
    { t:'¿Quién es el técnico con más títulos de Premier League?', o:['Wenger','Guardiola','Alex Ferguson','Mourinho','Dalglish'], c:2 },
    { t:'¿Qué selección ganó la Eurocopa 1992?', o:['Alemania','Dinamarca','Países Bajos','URSS','Italia'], c:1 },
    { t:'¿Quién ganó la Copa América 2001?', o:['Brasil','Argentina','Colombia','Uruguay','México'], c:2 },
    { t:'¿En qué club debutó profesionalmente Zlatan Ibrahimović?', o:['Ajax','Juventus','Malmö FF','Feyenoord','Hammarby'], c:2 },
    { t:'¿Qué portero detuvo el mano a mano decisivo a Robben en la final del Mundial 2010?', o:['Neuer','Casillas','Stekelenburg','Buffon','Lloris'], c:1 },
    { t:'¿Qué equipo ganó la primera Copa de Europa (1956)?', o:['Real Madrid','Stade de Reims','Milan','Benfica','Barcelona'], c:0 },
    { t:'¿Qué club es conocido como “Die Schwarzgelben”?', o:['Leverkusen','Borussia Dortmund','Wolfsburg','Eintracht Frankfurt','RB Leipzig'], c:1 }
  ];

  function $(sel){ return document.querySelector(sel); }
  function shuffle(a){ return a.map(function(v){return {v:v,r:Math.random()};}).sort(function(x,y){return x.r-y.r;}).map(function(x){return x.v;}); }

  function getLeaderboard(){
    try{ return JSON.parse(localStorage.getItem(LS.leaderboard)||'[]'); }catch(e){ return []; }
  }
  function saveScore(entry){
    var list=getLeaderboard(); list.push(entry);
    localStorage.setItem(LS.leaderboard, JSON.stringify(list));
  }
  function isNameTaken(name){
    var list=getLeaderboard();
    var lower=(name||'').toLowerCase();
    for(var i=0;i<list.length;i++){ if((list[i].name||'').toLowerCase()===lower) return true; }
    return false;
  }

  var state={
    screen:'gate',
    pin:'',
    name:'',
    questions: shuffle(QUESTIONS).slice(0, QUESTIONS_COUNT),
    qIndex:0,
    answers: new Array(QUESTIONS_COUNT).fill(-1),
    left: SECONDS_PER_QUESTION,
    timer:null
  };
  var locked=false; // evita clics dobles

  function render(){
    var app = $('#app');
    app.classList.remove('show');
    setTimeout(function(){
      app.innerHTML = screens[state.screen]();
      app.classList.add('show');
      bind();
    },120);
  }

  var screens={
    gate: function(){
      var html='';
      html += '<div class="center">';
      html += '  <div class="row" style="justify-content:center;gap:10px;margin-bottom:8px">';
      html += '    <div class="pill"><span>⚽️</span> Fútbol Quiz — Duro</div>';
      html += '  </div>';
      html += '  <h1>Introduce el PIN</h1>';
      html += '  <input id="pin" type="tel" inputmode="numeric" placeholder="PIN">';
      html += '  <div style="height:8px"></div>';
      html += '  <button id="goName" class="btn" disabled>Continuar</button>';
      html += '</div>';
      return html;
    },
    name: function(){
      var html='';
      html += '<h1>Elige un nombre único</h1>';
      html += '<input id="player" maxlength="20" placeholder="Tu nombre">';
      html += '<div style="height:8px"></div>';
      html += '<button id="start" class="btn">Empezar</button>';
      html += '<p class="muted">Se mostrará un ranking histórico al terminar.</p>';
      return html;
    },
    quiz: function(){
      var q=state.questions[state.qIndex];
      var progress = 100*(SECONDS_PER_QUESTION - state.left)/SECONDS_PER_QUESTION;
      var html='';
      html += '<div class="row small"><div>Pregunta '+(state.qIndex+1)+'/'+QUESTIONS_COUNT+'</div><div id="counter">'+state.left+'s</div></div>';
      html += '<div class="progress"><div class="bar" id="bar" style="width:'+progress+'%"></div></div>';
      html += '<div class="question">'+q.t+'</div>';
      html += '<div class="opts" id="opts">';
      for(var i=0;i<q.o.length;i++){
        html += '<button class="opt" data-i="'+i+'">'+q.o[i]+'</button>';
      }
      html += '</div>';
      html += '<div id="nextSlot" style="margin-top:12px"></div>';
      return html;
    },
    summary: function(){
      var calc = calcScore();
      var html='';
      html += '<h2>Resultados</h2>';
      html += '<div class="row small"><div>Puntos aciertos: '+calc.base+'</div><div>Bonus racha: +'+calc.bonus+'</div></div>';
      html += '<div class="row small"><div>Total:</div><div style="font-weight:800">'+calc.total+'</div></div>';
      html += '<div class="list" style="margin-top:8px">';
      for(var idx=0; idx<state.questions.length; idx++){
        var q=state.questions[idx];
        html += '<div class="rowitem">';
        html += '  <div class="small" style="flex:1;margin-right:8px">'+(idx+1)+'. '+q.t+'</div>';
        html += '  <div class="small" style="flex:1">';
        for(var i=0;i<q.o.length;i++){
          var isC = (i===q.c);
          var isS = (state.answers[idx]===i);
          var bg = isC ? 'var(--ok)' : (isS ? 'var(--wrong)' : '#fff');
          var style = 'background:'+bg+';border-radius:10px;padding:4px 8px;margin-left:6px';
          html += '<span style="'+style+'">'+q.o[i]+'</span>';
        }
        html += '  </div>';
        html += '</div>';
      }
      html += '</div>';
      html += '<div class="row" style="margin-top:10px">';
      html += '  <button id="save" class="btn" style="flex:1">Guardar y ver ranking</button>';
      html += '  <button id="replay" class="input" style="flex:1;text-align:center;font-weight:600">Rejugar</button>';
      html += '</div>';
      return html;
    },
    leaderboard: function(){
      var html='';
      html += '<h2>Ranking histórico</h2>';
      html += '<div id="lb" class="list" style="margin-top:8px"></div>';
      html += '<div style="height:8px"></div>';
      html += '<button id="home" class="input" style="width:100%;text-align:center;font-weight:600">Volver al inicio</button>';
      html += '<p class="muted">Icono: balón de fútbol. Animaciones: fade. Optimizado para móvil vertical.</p>';
      html += '<button id="clear" class="input" style="width:100%;text-align:center;font-weight:600;margin-top:6px">Borrar ranking local</button>';
      return html;
    }
  };

  function bind(){
    if (state.screen==='gate'){
      var pin=$('#pin'); var go=$('#goName');
      pin.value=state.pin;
      pin.oninput=function(e){ state.pin=e.target.value; go.disabled=(state.pin!==PIN_CODE); };
      go.onclick=function(){ if(state.pin===PIN_CODE){ state.screen='name'; render(); } };
      document.addEventListener('keydown', function onKey(e){
        if(e.key==='Enter' && state.screen==='gate' && state.pin===PIN_CODE){ 
          document.removeEventListener('keydown', onKey); 
          state.screen='name'; render(); 
        }
      });
    }
    if (state.screen==='name'){
      $('#player').value=state.name;
      $('#start').onclick=function(){
        var n = $('#player').value.trim();
        if(!n || n.replace(/\s+/g,'').length<2){ alert('El nombre debe tener al menos 2 caracteres.'); return; }
        if(isNameTaken(n)){ alert('Ese nombre ya existe. Elige otro.'); return; }
        state.name=n; startQuiz();
      };
    }
    if (state.screen==='quiz'){
      // timer visible sin re-render completo
      if(state.timer) clearInterval(state.timer);
      state.left=SECONDS_PER_QUESTION;
      var bar=$('#bar'), counter=$('#counter');
      state.timer=setInterval(function(){
        state.left -= 1;
        if(state.left<=0){
          clearInterval(state.timer);
          // si no contestó, mostrar solución y habilitar Siguiente
          showFeedbackAndNext(null);
        } else {
          if(counter) counter.innerText = state.left+'s';
          if(bar) bar.style.width = (100*(SECONDS_PER_QUESTION - state.left)/SECONDS_PER_QUESTION)+'%';
        }
      },1000);

      // opciones
      locked=false;
      var opts=document.querySelectorAll('.opt');
      for(var k=0;k<opts.length;k++){
        opts[k].onclick=function(){
          if(locked) return;
          locked=true;
          clearInterval(state.timer);
          var i = parseInt(this.getAttribute('data-i'),10);
          state.answers[state.qIndex]=i;
          showFeedbackAndNext(i);
        };
      }
    }
    if (state.screen==='summary'){
      $('#save').onclick=function(){
        var total = calcScore().total;
        saveScore({ name: state.name, score: total, date: new Date().toISOString() });
        state.screen='leaderboard'; render();
      };
      $('#replay').onclick=function(){ resetGame(true); };
    }
    if (state.screen==='leaderboard'){
      var list=getLeaderboard();
      var el=$('#lb'); var html='';
      list.sort(function(a,b){ return (b.score||0)-(a.score||0); });
      for(var i=0;i<Math.min(list.length,50);i++){
        html += '<div class="rowitem"><div class="row" style="gap:10px"><strong>'+(i+1)+'</strong><span>'+list[i].name+'</span></div><strong>'+list[i].score+'</strong></div>';
      }
      el.innerHTML=html;
      $('#home').onclick=function(){ resetGame(false); };
      var clr=$('#clear'); if(clr){ clr.onclick=function(){ localStorage.removeItem(LS.leaderboard); render(); }; }
    }
  }

  function showFeedbackAndNext(selectedIndex){
    var q = state.questions[state.qIndex];
    var opts=document.querySelectorAll('.opt');
    for(var j=0;j<opts.length;j++){
      var idx = parseInt(opts[j].getAttribute('data-i'),10);
      if (idx===q.c){ opts[j].style.background='var(--ok)'; opts[j].style.color='#fff'; }
      else if (selectedIndex!==null && idx===selectedIndex){ opts[j].style.background='var(--wrong)'; }
      else { opts[j].style.opacity=0.6; }
      opts[j].disabled = true;
    }
    var slot = $('#nextSlot');
    if(slot && !slot.firstChild){
      var btnNext = document.createElement('button');
      btnNext.innerText = 'Siguiente';
      btnNext.className = 'btn';
      btnNext.style.width='100%';
      btnNext.onclick = function(){ nextQ(); };
      slot.appendChild(btnNext);
    }
  }

  function nextQ(){
    if(state.qIndex+1<QUESTIONS_COUNT){ state.qIndex++; render(); }
    else { clearInterval(state.timer); state.screen='summary'; render(); }
  }

  function calcScore(){
    var base=0, streak=0, maxStreak=0;
    for(var i=0;i<QUESTIONS_COUNT;i++){
      var q=state.questions[i], a=state.answers[i];
      if(a===q.c){ base+=1; streak+=1; } else { streak=0; }
      if(streak>maxStreak) maxStreak=streak;
    }
    var bonus = Math.floor(maxStreak / STREAK_BONUS_AT);
    return { base:base, bonus:bonus, total: base+bonus, maxStreak:maxStreak };
  }

  function startQuiz(){
    if(state.timer) clearInterval(state.timer);
    state.screen='quiz'; state.qIndex=0; state.answers=new Array(QUESTIONS_COUNT).fill(-1);
    state.left = SECONDS_PER_QUESTION; render();
  }

  function resetGame(replay){
    state.questions=shuffle(QUESTIONS).slice(0,QUESTIONS_COUNT);
    state.qIndex=0; state.answers=new Array(QUESTIONS_COUNT).fill(-1);
    state.left=SECONDS_PER_QUESTION; if(state.timer) clearInterval(state.timer);
    state.screen = replay ? 'quiz' : 'gate'; state.pin=''; render();
  }

  render();
})();
</script>
</body>
</html>